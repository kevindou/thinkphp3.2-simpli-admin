<div class="row-fluid">
    <div class="box span12">
        <!--前面导航信息-->
        <div class="box-header" data-original-title="">
            <h2>
                <i class="icon-desktop"></i>
                <span class="break"></span>
            </h2>
            <div class="box-icon">
                <a title="添加" href="javascript:myTable.insert()">
                    <i class="icon-plus"></i>
                </a>
                <a id="table-refresh" title="刷新" href="#" onclick="return myTable.search();">
                    <i class="icon-refresh"></i>
                </a>
                <a id="toggle-fullscreen" class="hidden-phone hidden-tablet" title="全屏" href="#">
                    <i class="icon-fullscreen"></i>
                </a>
                <a class="btn-minimize" title="隐藏" href="#">
                    <i class="icon-chevron-up"></i>
                </a>
                <a class="btn-close" title="删除" href="#">
                    <i class="icon-remove"></i>
                </a>
            </div>
        </div>
        <div class="box-content">
            <!--表格数据-->
            <table class="table table-striped table-bordered table-hover" id="showTable">
            </table>
        </div>
    </div>
</div>
<script type="text/javascript" src="__PUBLIC__/js/layer/extend/layer.ext.js"></script>
<script type="text/javascript">
    var myTable = new MeTable({
        tableId:"showTable",
        baseUrl:"{:U('Article/update')}",
        formOptions:{"enctype":"multipart/form-data"},
    },{
        "aoColumns":[
            {"data":"id", "title":"ID", "sName":"id", "edit":{"type":"hidden"}, "search":{"type":"text"}},
            {"data":"title", "sName":"title", "title":"文章标题", "edit":{"type":"text","options":{"required":1,"rangelength":"[2, 50]"}}, "search":{"type":"text"}, 'createdCell':function(td, data, rowdata, row, col){
                var str = ! empty(rowdata) ? '<a class="quick-button-small span" onclick="myTable.seeTitle(' + row + ', this)">'+data.substr(0, 5)+'...</a>': data;
                $(td).html(str);
            }},
            {"data":"content", "sName":"content","title":"文章内容", "edit":{"type":"textarea", "options":{"required":1, "rangelength":"[2,200]"}}, 'createdCell':function(td, data, rowdata, row, col){
                var str = '<a class="quick-button-small span" onclick="myTable.seeContent(' + row + ', this)"><i class="icon-comments-alt blue"></i>'+data.substr(0, 10)+'...<span class="notification green">' + data.length + '</span></a>';
                $(td).html(str);
            }},
            {"data":"img", "sName":"img", "title":"文章导图", "edit":{"type":"file", "options":{"rangelength":"[1,50]"}}, "createdCell":stringToImage},
            {"data":"status", "sName":"status","title":"状态","value":{"1":"启用", "0":"停用"}, "createdCell":statusToString, "edit":{"type":"radio","default": 1, "options":{"required":1, "number":1}}, "search":{"type":"select"}},
            {"data":"recommend", "sName":"recommend","title":"推荐","value":{"1":"推荐", "0":"不推荐"}, "createdCell":recommendToString, "edit":{"type":"radio","default": 0, "options":{"required":1, "number":1}}, "search":{"type":"select"}},
            {"data":"see_num","sName":"see_num", "title":"浏览量"},
            {"data":"comment_num","sName":"comment_num", "title":"评论量"},
            {"data":"create_time", "sName":"create_time","title":"创建时间", "createdCell":dateTimeString},
            {"data":"update_time", "sName":"update_time", "title":"修改时间", "createdCell":dateTimeString},
            {"data": null, "title":"操作", "bSortable":false, "createdCell":setOperate},
        ],
    });

    // 查看标题
    myTable.seeTitle = function(row, obj){
        var data = this.table.data()[row];
        layer.tips(data.title, obj, {tips: [3, '#78BA32']});
    };

    // 查看内容
    myTable.seeContent = function(row){
        var data = this.table.data()[row];
        var index = layer.open({
            type: 1,
            title:data.title + ' 内容详情',
            content: data.content,
            area: ['50%', '50%'],
            shadeClose:true,
            maxmin: true
        });

        if (data.content.length > 1000) layer.full(index);
    }

    // 查看图片
    myTable.seeImage = function(row) {
        var data = this.table.data()[row];
        layer.photos({
            photos: {
                "title": data.Title,    // 相册标题
                "id": 1,                // 相册id
                "start": 0,             // 初始显示的图片序号，默认0
                "data": [               //  相册包含的图片，数组格式
                    {
                        "alt": data.title,
                        "pid": data.id,     // 图片id
                        "src": data.img,    // 原图地址
                        "thumb": data.img  // 缩略图地址
                    }
                ]
            }
        });
    }
</script>